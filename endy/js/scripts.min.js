'use strict';
window.onload = function() {

	// Hamburger menu

	var hamburger = document.querySelector('.hamburger'),
		menu = document.querySelector('.menu'),
		header =  document.querySelector('.header');

	function addActive() {
		hamburger.classList.add('hamburger--active');
		menu.classList.add('menu--active');
		if (window.matchMedia('(max-width: 1023px)').matches) {
			document.body.classList.add('overflow-hidden');
		};
	};

	function removeActive() {
		hamburger.classList.remove('hamburger--active');
		menu.classList.remove('menu--active');
		if (window.matchMedia('(max-width: 1023px)').matches) {
			document.body.classList.remove('overflow-hidden');
		};
	};

	hamburger.addEventListener('click', function(){
		if (!hamburger.classList.contains('hamburger--active')) {
			addActive();
		} else {
			removeActive();
		};
	});



	// Sticky header and his rules

	var secMain = document.querySelector('.sec-main');

	function toStick() {
		if (window.matchMedia('(min-width: 1024px)').matches) {
			var coordOfChange = secMain.offsetHeight;
			if (window.pageYOffset >= coordOfChange ) {
				if (!header.classList.contains('sticky')) {
					header.classList.add('sticky');
					removeActive();
				};
			} else {
				if (header.classList.contains('sticky')) {
					header.classList.remove('sticky');
					removeActive();
				};
			};
		};
	};

	window.addEventListener('scroll', toStick);

	window.onresize = function() {
		if (window.matchMedia('(max-width: 1023px)').matches) {
			header.classList.remove('sticky');
			removeActive();
		};
	};

	// Submit verification

	var modal = document.querySelector('.modal-cover'),
		button = document.querySelector('.form-contact__button'),
		form = document.querySelector('.form-contact'),
		modalMessage = modal.querySelector('.modal-message');


/*	
	function submitter() {	
		let url = '../act.php';
		let formData = new FormData();
		
		let name = document.querySelector('[name="user-name"]').value;
		let phone = document.querySelector('[name="user-phone"]').value;
		let email = document.querySelector('[name="user-email"]').value;
		let city = document.querySelector('[name="user-city"]').value;
		let msg = document.querySelector('[name="user-message"]').value;

		formData.append('name', name);
		formData.append('phone', phone);
		formData.append('email', email);
		formData.append('city', city);
		formData.append('message', msg);

		let options = {
			method: 'post',
			mode: 'cors',
			body: form
		};

		let req = new Request(url, options);

		fetch(req)
			.then((response) => {
				return response.json();
			})	
			.then( (j) => {
				console.log(j);
			})
			.catch( (err) => {
				console.log('ERROR: ', err.message);
			});
	};
*/

	
	//Submit popup
	
	form.onsubmit = function(){
		// submitter();

		// Симуляция ответа сервера
		var result = true; 
		
		if (result) {
			modalMessage.innerHTML = 'Заявка отправлена успешно!'
			document.querySelector(".form-contact").reset();
		} else {
			modalMessage.innerHTML = 'Ошибка отправки!';
		};
		modal.classList.add('modal-open');

		var delay = setTimeout(function(){
			modal.classList.remove('modal-open')
		}, 3000);

		modal.addEventListener('click', function(){
			clearTimeout(delay);
			modal.classList.remove('modal-open');
		});
		return false;
	};




}